$(document).ready(function(){var n,t;$(".no-placeholder").on("focus",".floatingLabel input, .floatingLabel textarea",function(){$(this).closest(".floatingLabel").addClass("hideLabel")});$(".no-placeholder").on("blur",".floatingLabel input, .floatingLabel textarea",function(){$(this).val()===""&&$(this).closest(".floatingLabel").removeClass("hideLabel")});$(".no-placeholder").on("click",".floatingLabel",function(){var n=$(this);n.hasClass("hideLabel")||(n.addClass("hideLabel"),n.find("input[type='text'], textarea").get(0).focus())});$(".no-placeholder").on("click",".btn_cancel",function(){$(this).closest(".container_form").find(".hideLabel").removeClass("hideLabel")});if(!Modernizr.mobile)$(document).on("keyup",".autoGrow",function(){var i=this.scrollHeight,r=this.clientHeight,n=$(this),u=n.offset().top;if(i>r){var t=parseInt(n.css("line-height"),10),f=$(window).height(),e=u+i+5*(t?t:25);e+150>=f?(this.style.overflow="auto",n.hasClass("hasGrown")||n.height(r+5*(t?t:25)+"px")):n.height(i+5*(t?t:25)+"px");n.addClass("hasGrown")}});$("input[type=textbox], textarea").on("paste",function(){var t=$(this),i=t,n=0;if(this.hasAttribute("maxlength")){n=t.attr("data-maxlength")||t.attr("maxlength");t.removeAttr("maxlength");t.on("blur.pasteTruncate",function(t){t.stopImmediatePropagation();var r=$(this);r.val().length>n&&(r.attr("maxlength",n).prop("maxlength",n),r.val(r.val().substring(0,n-1)),Utility.alert(Localizer.fnStringReplace(Localizer.Messages.truncatedstring,{"0":n})));i.off("blur.pasteTruncate")})}});$(window).on("beforeunload",function(){$("#text_search").val("")});$(document).on("click",".externalLink",function(n){var i=!1,t,r;try{$(this.href).find("script").length&&(n.preventDefault(),n.stopImmediatePropagation(),i=!0)}catch(n){}if(!i)if($(this).find(".spoiler").length)n.preventDefault();else if(t=this.href.replace(/[\<]/gi,"%3C"),t=t.replace(/[\>]/gi,"%3E"),!t.match(bungieNetPlatform.platformSettings.internalLinkRegex)){if(typeof viewModels!="undefined"&&viewModels.loggedInUserModelIsLoaded()&&viewModels.loggedInUserModel().adultMode())return;n.preventDefault();r={"0":t};Utility.alert(Localizer.fnStringReplace(Localizer.Messages.externallinkmessage,r));$("#alert").addClass("warning")}});n="";$(document).on("mouseover",".btn_quote",function(){n=window.getSelection().toString()});$(document).on("click",".bbcode a",function(t){var s,o;t.preventDefault();var f=$(this),r=f.closest(".container_textarea").find("textarea"),c=r.get(0),e=Utility.getInputSelectionPosition(c),h=n!==""?n:"",u=!1,i="";e.start>-1&&e.end>0&&e.end!==e.start&&(u=!0,i=[r.val().slice(0,e.start),"[$1]",r.val().slice(e.start)].join(""),i=[i.slice(0,e.end+4),"[$2]",i.slice(e.end+4)].join(""));f.hasClass("btn_bold")?u?(i=i.replace("[$1]","[b]"),i=i.replace("[$2]","[/b]"),r.val(i)):r.val(r.val()+" [b][/b]"):f.hasClass("btn_italic")?u?(i=i.replace("[$1]","[i]"),i=i.replace("[$2]","[/i]"),r.val(i)):r.val(r.val()+" [i][/i]"):f.hasClass("btn_underline")?u?(i=i.replace("[$1]","[u]"),i=i.replace("[$2]","[/u]"),r.val(i)):r.val(r.val()+" [u][/u]"):f.hasClass("btn_quote")?u?(i=i.replace("[$1]","[quote]"),i=i.replace("[$2]","[/quote]"),r.val(i)):h!==""?r.val(r.val()+"[quote]"+h+"[/quote]"):(s="",r.closest(".postCreation").hasClass("edit")?(o=r.closest("[data-actualParentPostId]").attr("data-actualParentPostId"),s=$("li[id="+o+"], #forumPost[data-postId="+o+"]").length?$("li[id="+o+"], #forumPost[data-postId="+o+"]").find(".post_body").first().html():""):s=r.closest(".post").find(".post_body").html(),r.val(r.val()+(r.val()!==""?" ":"")+"[quote]"+Utility.decodeHTML(Bnet.Utilities.Parse.bbCodesReverse(s))+"[/quote]")):f.hasClass("btn_spoiler")?u?(i=i.replace("[$1]","[spoiler]"),i=i.replace("[$2]","[/spoiler]"),r.val(i)):r.val(r.val()+" [spoiler][/spoiler]"):f.hasClass("btn_armory")?u?(i=i.replace("[$1]","[armory]"),i=i.replace("[$2]","[/armory]"),r.val(i)):r.val(r.val()+" [armory][/armory]"):f.hasClass("btn_link")?u?(i=i.replace("[$1]","[url]"),i=i.replace("[$2]","[/url]"),r.val(i)):r.val(r.val()+" [url][/url]"):f.hasClass("btn_namedlink")&&(u?(i=i.replace("[$1]","[url="+PageUrls.root+"]"),i=i.replace("[$2]","[/url]"),r.val(i)):r.val(r.val()+" [url="+PageUrls.root+"]link[/url]"));u=!1;$(".bbcode").next("textarea").focus()});$("body.Community.Tags").length&&(t=setTimeout(function(){$(".dualColList:empty").length&&$(".dualColList").append($("<li/>").text("No tags found."))},5e3));$(document).on("focus","input,textarea",function(){Modernizr.ie&&($(this).attr("placeholder")&&$(this).data("placeholder",$(this).attr("placeholder")),$(this).val()===$(this).attr("placeholder")&&$(this).val(""))})});$(document).on("click focus keyup","input, textarea",function(){var n=$(this),i=this,t;t=n.parent().find(".error:visible").length?n.parent().find(".error:visible"):$(".error:visible").filter(function(){var n=$(this);if(n.data("for").length)return n.data("for").get(0)===i});t.remove();n.removeClass("has-error").closest(".has-error").removeClass("has-error")})