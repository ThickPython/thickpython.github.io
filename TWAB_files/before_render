var Bnet,ViewModels,viewModels,populate_myIgnoredModels,update_myIgnoredModelsEntry,populate_myFollowedTagsModels,populate_followedModels,populate_myFollowersModels,populate_followersModel;(function(n){var i=function(){function n(n,t){this.name=n;this.query=t}return n.prototype.test=function(){return Modernizr.mq(this.query)},n}(),t,r;n.ReactiveMediaQuery=i,function(n){n[n.max=0]="max";n[n.gridmax=1]="gridmax";n[n.large=2]="large";n[n.medium=3]="medium";n[n.mobile=4]="mobile";n[n.tiny=5]="tiny";n[n.pico=6]="pico"}(t=n.ReactiveSize||(n.ReactiveSize={}));r=function(){function n(){this.mediaQueries=[n.max,n.gridmax,n.large,n.medium,n.mobile,n.tiny,n.pico];n.instance=this}return n.prototype.initialize=function(){this.determineMq();this.addListeners()},n.prototype.addListeners=function(){var n=this;$(window).on("resize",function(){n.determineMq()})},n.prototype.determineMq=function(){for(var r=this.mediaQueries,n=0,f=r.length;n<f;n++){var i=r[n],e="react-"+t[i.name],u=i.test();$("html").toggleClass(e,u);this.updateCurrentReactiveState(t[t[i.name]],u)}},n.prototype.updateCurrentReactiveState=function(n,t){typeof this.reactiveState=="undefined"&&(this.reactiveState=[]);this.reactiveState.indexOf(n)===-1?t&&(this.reactiveState.push(n),this.broadcastUpdate(n,!0)):t||(this.reactiveState.splice(this.reactiveState.indexOf(n),1),this.broadcastUpdate(n,!1))},n.prototype.broadcastUpdate=function(n,t){$(document).trigger("ReactUpdated",{reactiveSize:n,mediaQueryTest:t})},n.mobileNavEnabled=$("html").hasClass("mobile-nav-enabled"),n.max=new i(t.max,"only screen"),n.gridmax=new i(t.gridmax,"only screen and (max-width : 1664px)"),n.large=new i(t.large,"only screen and (max-width : 1200px)"),n.medium=new i(t.medium,"only screen and (max-width : 992px)"),n.mobile=new i(t.mobile,"only screen and (max-width : 768px)"),n.tiny=new i(t.tiny,"only screen and (max-width : 480px)"),n.pico=new i(t.tiny,"only screen and (max-width : 350px)"),n}();n.Reactive=r})(Bnet||(Bnet={})),function(n){var t;(function(t){function i(){t.reactive=new n.Reactive;t.reactive.initialize()}t.initialize=i;t.initialize()})(t=n.BeforeRender||(n.BeforeRender={}))}(Bnet||(Bnet={}));ViewModels=ViewModels||function(){};viewModels=viewModels||new ViewModels;viewModels.signedIn=ko.observable();viewModels.hash=ko.observableArray();viewModels.isLoggedIn=ko.observable(!1);viewModels.loggedInUserModel=ko.observable(ko.mapping.fromJS(UserDetail));viewModels.loggedInUserModelIsLoaded=ko.observable(!1);viewModels.loggedInUserClansModel=ko.observableArray();viewModels.loggedInUserClansModelIsLoaded=ko.observable(!1);viewModels.currentUser=ko.observableArray();viewModels.currentUrl=ko.observable(window.location);viewModels.onPageUserModel=ko.observable(ko.mapping.fromJS(GeneralUser));viewModels.onPageUserModelIsLoaded=ko.observable(!1);viewModels.checkAcl=function(n){return viewModels.loggedInUserModelIsLoaded()&&typeof viewModels.loggedInUserModel().userAcls!="undefined"&&viewModels.loggedInUserModel().userAcls()&&viewModels.loggedInUserModel().userAcls().length>0&&viewModels.loggedInUserModel().userAcls().indexOf(n)>-1?!0:!1};viewModels.canDeletePosts=ko.computed(function(){return viewModels.checkAcl(Globals.AclEnum.BNextDeleteForumTopics)});viewModels.isReporter=ko.computed(function(){return viewModels.checkAcl(Globals.AclEnum.BNextForumNinja)});viewModels.isBungieReporter=ko.computed(function(){return viewModels.checkAcl(Globals.AclEnum.BNextForumNinja)&&viewModels.checkAcl(Globals.AclEnum.BNextBungieGold)});viewModels.canEditAnyPost=ko.computed(function(){return viewModels.checkAcl(Globals.AclEnum.BNextEditAnyPublicPost)});viewModels.isReportOverturner=ko.computed(function(){return viewModels.checkAcl(Globals.AclEnum.BNextOverturnReports)});viewModels.isGlobalIgnoreAdmin=ko.computed(function(){return viewModels.checkAcl(Globals.AclEnum.BNextGlobalIgnore)});viewModels.isUserEditor=ko.computed(function(){return viewModels.checkAcl(Globals.AclEnum.BNextEditUsers)});viewModels.isAdminHistoryViewer=ko.computed(function(){return viewModels.checkAcl(Globals.AclEnum.BNextAdminHistory)});viewModels.isFounderInAllGroups=ko.computed(function(){return viewModels.checkAcl(Globals.AclEnum.BNextFounderInAllGroups)});viewModels.isCommunityContentCurator=ko.computed(function(){return viewModels.checkAcl(Globals.AclEnum.BNextCommunityContentCurator)});viewModels.isPrivateDataReader=ko.computed(function(){return viewModels.checkAcl(Globals.AclEnum.BNextPrivateUserDataReader)});viewModels.ignoredUsersModel=ko.observableArray();viewModels.ignoredUsersHasMore=ko.observable(!1);viewModels.ignoredGroupsModel=ko.observableArray();populate_myIgnoredModels=function(n){for(var t=0;t<n.users.length;t++)update_myIgnoredModelsEntry(n.users[t])};update_myIgnoredModelsEntry=function(n){var t=arrayFirstIndexOf(viewModels.ignoredUsersModel(),function(t){return t.user.membershipId()===n.user.membershipId});t>-1?viewModels.ignoredUsersModel.replace(viewModels.ignoredUsersModel()[t],ko.mapping.fromJS(n)):viewModels.ignoredUsersModel.push(ko.mapping.fromJS(n))};viewModels.myFollowedTagsModel=ko.observableArray([]);viewModels.myFollowedTagsModelIsLoaded=ko.observable(!1);viewModels.myFollowedUsersModel=ko.observableArray([]);viewModels.myFollowedUsersModelIsLoaded=ko.observable(!1);viewModels.myFollowedGroupsModel=ko.observableArray([]);viewModels.myFollowedGroupsModelIsLoaded=ko.observable(!1);viewModels.myGroupsModelFollowed=ko.observableArray([]);viewModels.myGroupsModelJoined=ko.observableArray([]);viewModels.myGroupsModelFounded=ko.observableArray([]);populate_myFollowedTagsModels=function(n){for(var f,e,u=n.results,o=u.length,i=[],r,t=0;t<o;t++)r=u[t],f=arrayFirstIndexOf(viewModels.myFollowedTagsModel(),function(n){return n.following.identifier===r.following.identifier}),f==-1&&i.push(r);for(e=i.length,t=0;t<e;t++)viewModels.myFollowedTagsModel.push(i[t]);viewModels.myFollowedTagsModelIsLoaded(!0)};populate_followedModels=function(n,t){for(var e,f=n.results,o=f.length,u=[],r,i=0;i<o;i++)r=f[i],t===viewModels.myFollowedUsersModel&&(r=r.user),u.push(r);for(e=u.length,i=0;i<e;i++)t.push(u[i])};viewModels.myFollowersModel=ko.observableArray(ko.mapping.fromJS(SearchResultOfFollowerResponse.results)());populate_myFollowersModels=function(n){viewModels.myFollowersModel(n.results)};viewModels.myJoinedGroupsModel=ko.observableArray();viewModels.myPendingGroupsModel=ko.observableArray();viewModels.myFollowedGroupsModelFull=ko.observableArray();viewModels.followedTagsModel=ko.observableArray();viewModels.followedUsersModel=ko.observableArray();viewModels.followedGroupsModel=ko.observableArray();viewModels.usersError=ko.observable("");viewModels.tagsError=ko.observable("");viewModels.followersModel=ko.observable(ko.mapping.fromJS(SearchResultOfFollowerResponse));populate_followersModel=function(n){viewModels.followersModel(ko.mapping.fromJS(n))};viewModels.JoinedGroupsModel=ko.observableArray();viewModels.PendingGroupsModel=ko.observableArray();viewModels.FollowedGroupsModelFull=ko.observableArray();Modernizr.localstorage?localStorage.minimumAge_cookie?(viewModels.userMinimumAge=ko.observable(localStorage.minimumAge_cookie),$(document).ready(function(){viewModels.userMinimumAge()&&$(".ageGateContents").each(function(){var n=$(this),t=parseInt(n.attr("data-minimumAge"),10);viewModels.userMinimumAge()>=t&&(n.removeClass("hide"),n.parent().find(".ageGatePrompt").addClass("hide"),n.parent().find(".ageGateForbidden").addClass("hide"))})})):viewModels.userMinimumAge=ko.observable(0):viewModels.userMinimumAge=ko.observable(0);viewModels.userMinimumAge.subscribe(function(n){Modernizr.localstorage&&(localStorage.minimumAge_cookie=n)})