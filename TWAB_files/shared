var SignIn={},TagSuggestions;$(document).ready(function(){SignIn={decorateSignInAlert:function(n,t,i){n&&(typeof i!="undefined"&&i!==""&&$("#signInAlert").addClass(i),typeof t!="undefined"&&t!==""?n.before(t):n.before(Localizer.Userpages.validateaccountsignin))},showSignInAlert:function(){const n=new Bnet.Modal("sign-in",$("#steamRedirectModal").html());n.afterCloseCallback=()=>{window.location=window.location};n.open()},notSignedIn:function(){return myID_cookie!=="0"?!1:(this.showSignInAlert(),!0)}}});$(document).off("userLogOut");$(document).on("userLogOut",function(){$("body").hasClass("nosignout")||SignIn.showSignInAlert(Localizer.Userpages.signbackin,"noalert",!0)});TagSuggestions=function(n,t){n.length<1||t.length<1||(this.$el=n,this.$suggestionPanel=t,this.tagSuggestTimeout=!1,this.addEventListeners())};TagSuggestions.prototype.setSearchTagsPreviewTimeout=function(){var n=this;this.tagSuggestTimeout=setTimeout(function(){n.searchForTags(n.$el);n.clearSearchTagsTimeout()},500)};TagSuggestions.prototype.clearSearchTagsTimeout=function(){clearTimeout(this.tagSuggestTimeout);this.tagSuggestTimeout=!1};TagSuggestions.prototype.resetSearchTagsPreview=function(){this.$suggestionPanel.find("li").remove()};TagSuggestions.prototype.closeTagsPreview=function(){this.resetSearchTagsPreview();this.$suggestionPanel.removeClass("opened")};TagSuggestions.prototype.addEventListeners=function(){var n=this;this.$el.on("keyup.tagSuggest",function(){var t=$(this);if(t.val().length<3){n.closeTagsPreview();return}n.tagSuggestTimeout!==!1?(n.clearSearchTagsTimeout(),n.setSearchTagsPreviewTimeout(t)):n.setSearchTagsPreviewTimeout(t)});this.$suggestionPanel.on("click","li",function(){var s=$(this),f=s.text(),t=n.$el.val(),r=[],u=[],e=0,o=0,i;if(t.indexOf(" ")>-1){for(r=t.split(" "),u=Utility.getIndicesOf(" ",t,!1),e=Utility.getCaret(n.$el.get(0)),i=0;i<u.length;i++)u[i]<e&&o++;r[o]=f;t=r.join(" ")}else t=f;n.$el.val(t);n.closeTagsPreview()});this.$el.on("blur.tagSuggest",function(){setTimeout(function(){n.$el.is(":focus")||n.closeTagsPreview()},500)})};TagSuggestions.prototype.searchForTags=function(n){var t=this,r;if(n.val().length>2&&Utility.ValidateTags(n.val())){var i=n.val(),f=[],u=[],e=0,o=0;if(i.trim().indexOf(" ")>-1){for(f=i.split(" "),u=Utility.getIndicesOf(" ",i,!1),e=Utility.getCaret(this.$el.get(0)),r=0;r<u.length;r++)u[r]<e&&o++;i=f[o]}bungieNetPlatform.forumService.GetForumTagSuggestions(i,function(n){var i,r;if(n.length>0)for(t.resetSearchTagsPreview(),i=0;i<n.length;i++)t.$suggestionPanel.is(":visible")||t.$suggestionPanel.addClass("opened"),r="<li>"+n[i].tagText+"<\/li>",t.$suggestionPanel.append(r);else t.resetSearchTagsPreview()},function(){t.resetSearchTagsPreview()})}else this.resetSearchTagsPreview()}